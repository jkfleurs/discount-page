package discount;

import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class egaPtnuocsid extends JFrame {
    private static CardLayout cardLayout;
    private static JPanel mainPanel;

    static Font gugiFont = loadFont("src/discount/Gugi-Regular.ttf", 70f);
    static Font balooFont = loadFont("src/discount/Baloo-Regular.ttf", 25f);
    static Font poppinsFont = loadFont("src/discount/Poppins-Black.ttf", 20f);
    static Font robotoFlexFont = loadFont("src/discount/RobotoFlex.ttf", 20f);

    private static Font loadFont(String path, float size) {
        try {
            Font font = Font.createFont(Font.TRUETYPE_FONT, new java.io.File(path)).deriveFont(size);
            GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
            ge.registerFont(font);
            return font;
        } catch (Exception e) {
            e.printStackTrace();
            return new Font("SansSerif", Font.PLAIN, (int) size);
        }
    }

    public static void main(String[] args) {
        JFrame frame = new JFrame("Discount Page");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(400, 600);
        frame.setLocationRelativeTo(null);

        cardLayout = new CardLayout();
        mainPanel = new JPanel(cardLayout);

        mainPanel.add(discountOptions(), "DiscountOptions");
        mainPanel.add(register("Senior"), "Senior");
        mainPanel.add(register("Member"), "Member");
        mainPanel.add(register("PWD"), "PWD");
        mainPanel.add(blank(), "NextPage");

        frame.add(mainPanel);
        frame.setVisible(true);
    }

    private static JPanel discountOptions() {
        JPanel panel = new JPanel(new BorderLayout());
        panel.setBackground(Color.WHITE);
        panel.add(topBar(), BorderLayout.NORTH);

        JPanel center = new JPanel();
        center.setBackground(Color.WHITE);
        center.setLayout(new BoxLayout(center, BoxLayout.Y_AXIS));
        center.setAlignmentX(Component.CENTER_ALIGNMENT);

        JLabel title = new JLabel("K. Co");
        title.setFont(gugiFont);
        title.setAlignmentX(Component.CENTER_ALIGNMENT);

        JLabel subtitle = new JLabel("Discount Options");
        subtitle.setFont(balooFont);
        subtitle.setAlignmentX(Component.CENTER_ALIGNMENT);

        JButton pwdBtn = menuButton("PWD", "PWD");
        JButton seniorBtn = menuButton("Senior", "Senior");
        JButton memberBtn = menuButton("Member", "Member");
        JButton skipBtn = menuButton("Skip", "NextPage");

        center.add(Box.createVerticalStrut(0));
        center.add(title);
        center.add(Box.createVerticalStrut(10));
        center.add(subtitle);
        center.add(Box.createVerticalStrut(30));
        center.add(pwdBtn);
        center.add(Box.createVerticalStrut(10));
        center.add(seniorBtn);
        center.add(Box.createVerticalStrut(10));
        center.add(memberBtn);
        center.add(Box.createVerticalStrut(10));
        center.add(skipBtn);

        panel.add(center, BorderLayout.CENTER);
        return panel;
    }

    private static JPanel register(String type) {
        JPanel panel = new JPanel(new BorderLayout());
        panel.setBackground(new Color(245, 245, 245));
        panel.add(topBar(), BorderLayout.NORTH);

        JPanel center = new JPanel();
        center.setBackground(Color.WHITE);
        center.setLayout(new BoxLayout(center, BoxLayout.Y_AXIS));
        center.setBorder(BorderFactory.createEmptyBorder(30, 50, 30, 50));
        center.setAlignmentX(Component.CENTER_ALIGNMENT);

        JLabel title = new JLabel("K. Co");
        title.setFont(gugiFont);
        title.setForeground(new Color(60, 60, 60));
        title.setAlignmentX(Component.CENTER_ALIGNMENT);

        JLabel subtitle = new JLabel("Register Card Number");
        subtitle.setFont(poppinsFont);
        subtitle.setForeground(new Color(100, 100, 100));
        subtitle.setAlignmentX(Component.CENTER_ALIGNMENT);

        JTextField cardInput = new JTextField();
        cardInput.setMaximumSize(new Dimension(300, 50));
        cardInput.setFont(robotoFlexFont);
        cardInput.setHorizontalAlignment(JTextField.CENTER);
        cardInput.setBorder(BorderFactory.createCompoundBorder(
            BorderFactory.createLineBorder(new Color(180, 180, 180), 2),
            BorderFactory.createEmptyBorder(10, 10, 10, 10)
        ));

        JLabel messageLabel = new JLabel(" ");
        messageLabel.setFont(poppinsFont.deriveFont(9f));
        messageLabel.setForeground(Color.RED);
        messageLabel.setAlignmentX(Component.CENTER_ALIGNMENT);

        JButton submitBtn = new JButton("Submit " + type) {
            protected void paintComponent(Graphics g) {
                Graphics2D g2 = (Graphics2D) g.create();
                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                g2.setColor(getBackground());
                g2.fillRoundRect(0, 0, getWidth(), getHeight(), 50, 50);
                super.paintComponent(g);
                g2.dispose();
            }

            protected void paintBorder(Graphics g) {}
            public boolean isContentAreaFilled() { return false; }
        };
        submitBtn.setFont(robotoFlexFont.deriveFont(Font.PLAIN, 20f));
        submitBtn.setBackground(new Color(121, 85, 72));
        submitBtn.setForeground(Color.WHITE);
        submitBtn.setFocusPainted(false);
        submitBtn.setAlignmentX(Component.CENTER_ALIGNMENT);
        submitBtn.setPreferredSize(new Dimension(250, 60));
        submitBtn.setMaximumSize(new Dimension(250, 60));

        submitBtn.addActionListener(e -> {
            String inputText = cardInput.getText();
            boolean isValid = false;

            if (type.equals("PWD")) {
                if (inputText.matches("\\d{2}-\\d{4}-\\d{3}-\\d{7}")) {
                    isValid = true;
                } else {
                    messageLabel.setText("Invalid PWD ID format! (RR-PPMM-BBB-NNNNNNN)");
                }
            } else if (type.equals("Member")) {
                if (inputText.matches("\\d{7}")) {
                    isValid = true;
                } else {
                    messageLabel.setText("Invalid Member Number!");
                }
            } else {
                if (!inputText.isEmpty() && inputText.matches("\\d+")) {
                    isValid = true;
                } else {
                    messageLabel.setText("Invalid input! Numbers only.");
                }
            }

            if (isValid) {
                messageLabel.setForeground(new Color(0, 153, 51));
                messageLabel.setText("Registered " + type + " Number: " + inputText);
                cardLayout.show(mainPanel, "NextPage");
            } else {
                messageLabel.setForeground(Color.RED);
            }
        });

        center.add(Box.createVerticalStrut(40));
        center.add(title);
        center.add(Box.createVerticalStrut(20));
        center.add(subtitle);
        center.add(Box.createVerticalStrut(30));
        center.add(cardInput);
        center.add(Box.createVerticalStrut(10));
        center.add(messageLabel);
        center.add(Box.createVerticalStrut(10));
        center.add(submitBtn);

        panel.add(center, BorderLayout.CENTER);
        return panel;
    }

    private static JPanel blank() {
        JPanel panel = new JPanel();
        panel.setBackground(Color.WHITE);
        return panel;
    }

    private static JPanel topBar() {
        JPanel topBar = new JPanel(new BorderLayout());
        topBar.setBackground(Color.WHITE);

        JButton backButton = new JButton("< Back");
        backButton.setFont(poppinsFont.deriveFont(Font.PLAIN, 12));
        backButton.setFocusPainted(false);
        backButton.setBorderPainted(false);
        backButton.setContentAreaFilled(false);
        backButton.setPreferredSize(new Dimension(80, 50));
        backButton.addActionListener(e -> cardLayout.show(mainPanel, "DiscountOptions"));

        topBar.add(backButton, BorderLayout.WEST);
        return topBar;
    }

    private static JButton menuButton(String text, String cardName) {
        JButton button = new JButton(text) {
            protected void paintComponent(Graphics g) {
                Graphics2D g2 = (Graphics2D) g.create();
                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                g2.setColor(getBackground());
                g2.fillRoundRect(0, 0, getWidth(), getHeight(), 40, 40);
                super.paintComponent(g);
                g2.dispose();
            }

            public boolean isContentAreaFilled() { return false; }
        };

        button.setAlignmentX(Component.CENTER_ALIGNMENT);

        Dimension size = new Dimension(250, 60);
        button.setPreferredSize(size);
        button.setMaximumSize(size);
        button.setMinimumSize(size);

        float fontSize = size.height * 0.4f;
        button.setFont(robotoFlexFont.deriveFont(Font.BOLD, fontSize));

        button.setFocusPainted(false);
        button.setBackground(new Color(121, 85, 72));
        button.setForeground(Color.WHITE);
        button.setOpaque(false);
        button.setBorderPainted(false);
        button.setHorizontalAlignment(SwingConstants.CENTER);
        button.setVerticalAlignment(SwingConstants.CENTER);

        button.addActionListener(e -> cardLayout.show(mainPanel, cardName));
        return button;
    }
}
